<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ProTech | Loading...</title>

        <meta name="description" content="" />
        <meta property="og:type" content="article" />
        <meta property="og:title" content="" />
        <meta property="og:description" content="" />
        <meta property="og:image" content="" />
        <meta name="twitter:card" content="summary_large_image" />

        <link
            href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;700&family=Inter:wght@400;500;700&display=swap"
            rel="stylesheet"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        />

        <style>
            :root {
                --bg-body: #0a0b10;
                --bg-card: #12141c;
                --accent-blue: #007aff;
                --text-primary: #ffffff;
                --text-secondary: #94a3b8;
                --border-color: #1e293b;
            }

            /* شريط تقدم القراءة */
            #progress-bar {
                position: fixed;
                top: 0;
                left: 0;
                width: 0%;
                height: 4px;
                background: var(--accent-blue);
                z-index: 2000;
                transition: width 0.1s;
            }

            body {
                font-family: "Inter", sans-serif;
                background-color: var(--bg-body);
                color: var(--text-primary);
                margin: 0;
                line-height: 1.8;
            }

            nav {
                background: rgba(13, 15, 22, 0.95);
                backdrop-filter: blur(12px);
                border-bottom: 1px solid var(--border-color);
                position: sticky;
                top: 0;
                z-index: 1000;
                display: flex;
                justify-content: space-between;
                align-items: center;
                height: 70px;
                padding: 0 40px;
            }

            .logo {
                font-family: "Space Grotesk", sans-serif;
                text-decoration: none;
                color: white;
                font-size: 1.5rem;
                font-weight: bold;
            }
            .logo span {
                color: var(--accent-blue);
            }

            .wrapper {
                max-width: 800px;
                margin: 40px auto;
                padding: 0 20px;
            }

            .article-header {
                text-align: left;
                margin-bottom: 40px;
            }
            .article-img {
                width: 100%;
                border-radius: 24px;
                margin-bottom: 30px;
                box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            }

            .meta-info {
                display: flex;
                align-items: center;
                gap: 15px;
                color: var(--text-secondary);
                font-size: 0.9rem;
                margin-bottom: 15px;
            }
            .cat-tag {
                background: var(--accent-blue);
                color: white;
                padding: 4px 12px;
                border-radius: 6px;
                font-weight: bold;
                text-transform: uppercase;
                font-size: 0.75rem;
            }

            h1 {
                font-family: "Space Grotesk", sans-serif;
                font-size: clamp(2rem, 5vw, 3.5rem);
                line-height: 1.1;
                margin: 10px 0 20px 0;
            }

            .content {
                font-size: 1.25rem;
                color: #cbd5e1;
            }
            .content p {
                margin-bottom: 25px;
            }

            /* أزرار المشاركة الذكية */
            .share-box {
                display: flex;
                gap: 10px;
                margin: 40px 0;
                padding: 20px 0;
                border-top: 1px solid var(--border-color);
                border-bottom: 1px solid var(--border-color);
                flex-wrap: wrap;
            }
            .share-btn {
                flex: 1;
                min-width: 120px;
                padding: 12px;
                border: none;
                border-radius: 12px;
                color: white;
                font-weight: bold;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
                transition: 0.3s;
                font-size: 0.9rem;
            }
            .btn-x {
                background: #000;
            }
            .btn-fb {
                background: #1877f2;
            }
            .btn-copy {
                background: #2d3748;
            }
            .share-btn:hover {
                opacity: 0.8;
                transform: translateY(-2px);
            }

            .related-section {
                margin-top: 60px;
                padding-top: 40px;
                border-top: 1px solid var(--border-color);
            }
            .related-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin-top: 20px;
            }

            @media (max-width: 768px) {
                nav {
                    padding: 0 20px;
                }
                .related-grid {
                    grid-template-columns: 1fr;
                }
                h1 {
                    font-size: 2.2rem;
                }
            }
        </style>
    </head>
    <body>
        <div id="progress-bar"></div>

        <nav>
            <a href="index.html" class="logo">PRO<span>TECH</span></a>
            <a
                href="index.html"
                style="color: white; text-decoration: none; font-size: 0.9rem"
                ><i class="fas fa-arrow-left"></i> BACK</a
            >
        </nav>

        <div class="wrapper">
            <main id="post-content">
                <div style="text-align: center; padding: 100px 0">
                    <i
                        class="fas fa-circle-notch fa-spin"
                        style="font-size: 2rem; color: var(--accent-blue)"
                    ></i>
                </div>
            </main>
        </div>

        <script src="/data.js"></script>
        <script>
            // 1. حساب وقت القراءة
            function calculateReadingTime(text) {
                const wordsPerMinute = 200;
                const words = text.split(/\s+/).length;
                return Math.ceil(words / wordsPerMinute);
            }

            // 2. تحديث شريط التقدم
            window.onscroll = function () {
                let winScroll =
                    document.body.scrollTop ||
                    document.documentElement.scrollTop;
                let height =
                    document.documentElement.scrollHeight -
                    document.documentElement.clientHeight;
                let scrolled = (winScroll / height) * 100;
                document.getElementById("progress-bar").style.width =
                    scrolled + "%";
            };

            // 3. دالة المشاركة والنسخ
            function copyLink() {
                navigator.clipboard.writeText(window.location.href);
                alert("Link copied to clipboard!");
            }

            function share(platform, title) {
                const url = encodeURIComponent(window.location.href);
                const text = encodeURIComponent(title);
                const links = {
                    x: `https://twitter.com/intent/tweet?text=${text}&url=${url}`,
                    fb: `https://www.facebook.com/sharer/sharer.php?u=${url}`
                };
                window.open(links[platform], "_blank", "width=600,height=400");
            }
            function loadArticle() {
                // جلب المسار وتنظيفه من العلامات المائلة الزائدة
                const path = window.location.pathname;
                const pathSegments = path
                    .split("/")
                    .filter(segment => segment.length > 0);

                // الحصول على الـ slug الأخير وحذف .html إذا وجد
                let currentSlug = pathSegments.pop();
                if (currentSlug) {
                    currentSlug = currentSlug.replace(".html", "");
                }

                // إذا لم يجد slug أو كان الرابط هو الملف نفسه، نوقف الدالة
                if (
                    !currentSlug ||
                    currentSlug === "post" ||
                    currentSlug === "index"
                ) {
                    return;
                }

                // البحث في مصفوفة المقالات (تأكد أن data.js محمل قبل هذا السكريبت)
                const article =
                    typeof articles !== "undefined"
                        ? articles.find(a => a.slug === currentSlug)
                        : null;
                const container = document.getElementById("post-content");

                if (!article) {
                    container.innerHTML = `
            <div style="text-align:center; padding:100px;">
                <h1>Article Not Found</h1>
                <p>Slug: ${currentSlug}</p>
                <a href="/" style="color:var(--accent-blue)">Return Home</a>
            </div>`;
                    return;
                }

                // تعبئة البيانات في الصفحة
                document.title = article.title + " | ProTech";
                const words = (article.content || "").split(/\s+/).length;
                const readTime = Math.ceil(words / 200);

                container.innerHTML = `
        <div class="article-header">
            <div style="display: flex; gap: 15px; color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 15px;">
                <span style="background: var(--accent-blue); color: white; padding: 4px 12px; border-radius: 6px; font-weight: bold; font-size: 0.75rem;">${article.cat.toUpperCase()}</span>
                <span><i class="far fa-clock"></i> ${readTime} min read</span>
            </div>
            <h1>${article.title}</h1>
            <p style="color: var(--text-secondary); font-size: 1.2rem;">${
                article.desc
            }</p>
        </div>
        <img src="${
            article.img
        }" class="article-img" style="width:100%; border-radius:24px; margin-bottom:30px; box-shadow: 0 20px 50px rgba(0,0,0,0.5);">
        <div class="content">${article.content}</div>
    `;
            }

            // تأكد من استدعاء الدالة عند التحميل
            window.addEventListener("load", loadArticle);
        </script>
    </body>
</html>